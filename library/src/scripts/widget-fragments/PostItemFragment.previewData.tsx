import type { IDiscussion } from "@dashboard/@types/api/discussion";
import type { IUserFragment } from "@library/@types/api/users";
import type { IDiscussionItemOptions } from "@library/features/discussions/DiscussionList.variables";
import type { IFragmentPreviewData } from "@library/utility/fragmentsRegistry";
import PostItem from "@vanilla/injectables/PostItemFragment";
import { uuidv4 } from "@vanilla/utils";

type PreviewData = IFragmentPreviewData<PostItem.Props>;

const userFragment: IUserFragment = {
    userID: -1,
    name: "System",
    url: "",
    photoUrl: "",
    dateLastActive: "2025-05-05T19:57:16+00:00",
    banned: 0,
    private: false,
};

const discussion: IDiscussion = {
    name: "Basic Post",
    url: "#",
    type: "discussion",
    postTypeID: "question",
    excerpt: "This content is generated by users on the site.",
    insertUserID: 1,
    insertUser: userFragment,
    updateUserID: null,
    sink: false,
    discussionID: -1,
    canonicalUrl: "#",
    dateInserted: "2025-05-05T19:57:16+00:00",
    pinned: false,
    countComments: 99,
    countViews: 99,
    categoryID: -1,
    closed: false,
    score: 99,
    dateUpdated: "2025-05-05T19:57:16+00:00",
    category: {
        categoryID: -1,
        name: "My Category",
        url: "#",
        allowedDiscussionTypes: ["discussion"],
    },
    countUnread: 9,
    unread: true,
    lastUser: userFragment,
    dateLastComment: "2025-01-01T19:57:16+00:00",
    lastUserID: 1,
    statusID: 1,
    resolved: true,
    internalStatusID: 8,
    internalStatus: {
        statusID: 8,
        state: "closed",
        name: "Resolved",
        recordType: "discussion",
        recordSubType: "discussion",
    },
    tags: [
        {
            tagID: 1,
            name: "My Tag",
            urlcode: "my-tag",
            type: "user",
        },
    ],
};

const commonMeta: Required<IDiscussionItemOptions>["metas"]["display"] = {
    commentCount: true,
    unreadCount: true,
    userTags: true,
    lastCommentDate: true,
    lastUser: true,
};

const Discussion: PreviewData = {
    name: "Basic Discussion",
    description: "A basic discussion with metadata, tags, and no featured image.",
    previewDataUUID: uuidv4(),
    data: {
        options: {
            excerpt: {
                display: true,
            },
            metas: {
                asIcons: false,
                display: {
                    commentCount: true,
                    unreadCount: true,
                    userTags: true,
                    lastCommentDate: true,
                    lastUser: true,
                },
            },
        },
        discussion: {
            ...discussion,
            name: "Let's talk about the thing",
        },
    },
};

const ReadDiscussion: PreviewData = {
    name: "Read Discussion",
    description: "A discussion that has been completely read by the current user.",
    previewDataUUID: uuidv4(),
    data: {
        options: {
            excerpt: {
                display: true,
            },
            metas: {
                asIcons: false,
                display: {
                    commentCount: true,
                    unreadCount: true,
                    userTags: true,
                    lastCommentDate: true,
                    lastUser: true,
                },
            },
        },
        discussion: {
            ...discussion,
            name: "Let's talk about the thing",
            countUnread: 0,
            unread: false,
        },
    },
};

const CheckedDiscussion: PreviewData = {
    name: "Discussion with Checkbox checked",
    description: "A discussion with a checkbox that has been checked.",
    previewDataUUID: uuidv4(),
    data: {
        options: {
            excerpt: {
                display: true,
            },
            metas: {
                asIcons: false,
                display: {
                    commentCount: true,
                    unreadCount: true,
                    userTags: true,
                    lastCommentDate: true,
                    lastUser: true,
                },
            },
        },
        discussion: {
            ...discussion,
            name: "Let's talk about the thing",
            countUnread: 0,
            unread: false,
        },
        isChecked: true,
    },
};

const Idea: PreviewData = {
    name: "Idea",
    description: "An idea post with an open status.",
    previewDataUUID: uuidv4(),
    data: {
        options: {
            excerpt: {
                display: true,
            },
            metas: {
                asIcons: false,
                display: {
                    commentCount: true,
                    unreadCount: true,
                    userTags: true,
                    lastCommentDate: true,
                    lastUser: true,
                    score: false,
                },
            },
        },
        discussion: {
            ...discussion,
            name: "I have an idea!",
            type: "idea",
            postTypeID: "idea",
            statusID: 10001,
            status: {
                statusID: 10001,
                name: "Open",
                state: "open",
                recordType: "discussion",
                recordSubType: "idea",
            },
            reactions: [
                {
                    tagID: 10,
                    urlcode: "Down",
                    name: "Vote Down",
                    class: "Negative",
                    hasReacted: false,
                    reactionValue: -1,
                    count: 0,
                },
                {
                    tagID: 11,
                    urlcode: "Up",
                    name: "Vote Up",
                    class: "Positive",
                    hasReacted: false,
                    reactionValue: 1,
                    count: 1,
                },
            ],
        },
    },
};

const Question: PreviewData = {
    name: "Question",
    description: "A question an accepted status.",
    previewDataUUID: uuidv4(),
    data: {
        options: {
            excerpt: {
                display: true,
            },
            featuredImage: {
                display: false,
            },
            metas: {
                asIcons: false,
                display: {
                    ...commonMeta,
                },
            },
        },
        discussion: {
            ...discussion,
            name: "How do you do the thing?",
            statusID: 3,
            type: "question",
            postTypeID: "question",
            status: {
                statusID: 3,
                name: "Accepted",
                recordType: "discussion",
                recordSubType: "question",
                state: "closed",
            },
        },
    },
};

const Minimal: PreviewData = {
    name: "Minimal",
    description: "A discussion post with minimal metadata.",
    previewDataUUID: uuidv4(),
    data: {
        options: {
            excerpt: {
                display: false,
            },
            featuredImage: {
                display: false,
            },
            metas: {
                display: {
                    category: false,
                    startedByUser: false,
                    lastUser: false,
                    viewCount: false,
                    lastCommentDate: false,
                    commentCount: false,
                    userTags: true,
                    unreadCount: false,
                    score: false,
                },
            },
        },
        discussion: {
            ...discussion,
        },
    },
};

const StressTest: PreviewData = {
    name: "Stress Test",
    description: "A discussion with all idea metadata, tags, featured image, and a long title & excerpt.",
    previewDataUUID: uuidv4(),
    data: {
        options: {
            excerpt: {
                display: true,
            },
            featuredImage: {
                display: true,
            },
            metas: {
                display: {
                    category: true,
                    startedByUser: true,
                    lastUser: true,
                    viewCount: true,
                    lastCommentDate: true,
                    commentCount: true,
                    userTags: true,
                    unreadCount: true,
                    score: true,
                },
            },
        },
        discussion: {
            ...discussion,
            name: "A discussion with a very very very very very long title and excerpt. This is a stress test of wrapping / responsiveness of the post title.",
            excerpt:
                "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis hendrerit ante pellentesque diam fermentum condimentum. Sed elit augue, maximus at ipsum eu, rhoncus elementum lorem. Integer vehicula ornare felis eu dignissim. Curabitur pellentesque, nibh eu blandit tristique, ex nunc pellentesque sapien, ut fermentum nulla eros mattis quam. Phasellus venenatis leo ut lorem pulvinar faucibus. Nam accumsan metus ullamcorper eros gravida, sed interdum neque eleifend.",
        },
    },
};

// Exported named for use in stories.
export const PostItemPreviewData = {
    Discussion,
    ReadDiscussion,
    CheckedDiscussion,
    Idea,
    Question,
    Minimal,
    StressTest,
};

const previewData: PreviewData[] = [Discussion, ReadDiscussion, CheckedDiscussion, Idea, Question, Minimal, StressTest];

export default previewData;
