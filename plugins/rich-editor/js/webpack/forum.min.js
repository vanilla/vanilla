(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{133:function(e,t,n){n(24),e.exports=n(141)},141:function(e,t,n){"use strict";n.r(t);var r=n(25),u=n(32),s=function(){function e(){this.MAX_PARTIAL_LOOKUP_ITERATIONS=10,this.root={}}return e.prototype.insert=function(e,t){for(var n=this.root,r=0;r<e.length;r++){var u=e[r];if(n.children||(n.children={}),!(u in n.children)){var s=r!==e.length-1?{}:{children:{}};n.children[u]=s}n=n.children[u]}n.value=t},e.prototype.getNode=function(e){var t=this.root;if(void 0===e)return t;for(var n=0;n<e.length;n++){var r=e.charAt(n);if(!t.children||!t.children[r])return null;t=t.children[r]}return t},e.prototype.getValue=function(e){var t=this.getNode(e);return t&&t.value||null},e.prototype.getValueFromPartialsOfWord=function(e){for(var t=Math.min(this.MAX_PARTIAL_LOOKUP_ITERATIONS,e.length);t>0;t--){var n=e.substring(0,t),r=this.getValue(n);if(null!=r)return r}return null},e}(),o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var u in t=arguments[n])Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u]);return e},i={lastSuccessfulUsername:null,currentUsername:null,usersTrie:new s,activeSuggestionID:"",activeSuggestionIndex:0};var a=n(33),c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var u in t=arguments[n])Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u]);return e},l={index:0,length:0},d={},f={currentSelection:l,lastGoodSelection:l};
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */function h(e,t){var n=e[t.payload.editorID];if(t.type===a.a&&n)throw new Error("Failed to create editor instance with id "+t.payload.editorID+". Id already exists");if(t.type!==a.a&&!n)throw new Error("Could not perform an action for editor ID "+t.payload.editorID+" that doesn't exist. Be sure to create an instance first.")}var v=n(14),g=Object(v.c)({mentions:function(e,t){switch(void 0===e&&(e=i),t.type){case u.b:var n=t.payload.username;e.usersTrie.insert(n,{status:"PENDING"});var r=!1,s=e.lastSuccessfulUsername;return null!=s&&n.length>s.length&&n.substring(0,s.length)===s&&(r=!0),o({},e,{currentUsername:n,lastSuccessfulUsername:r?e.lastSuccessfulUsername:null});case u.a:var a=t.payload,c=(n=a.username,a.error);return e.usersTrie.insert(n,{status:"FAILED",users:null,error:c}),e;case u.c:var l=t.payload,d=(n=l.username,l.users);e.usersTrie.insert(n,{status:"SUCCESSFUL",users:function(e,t){var n=Intl.Collator("en",{usage:"sort",sensitivity:"variant",ignorePunctuation:!0,numeric:!0});return e.sort(function(e,r){return e.name.includes(t)&&!r.name.includes(t)?-1:r.name.includes(t)&&!e.name.includes(t)?1:n.compare(e.name,r.name)})}(d,n)});var f=d.length>0?d[0].domID:"";return o({},e,{activeSuggestionID:f,activeSuggestionIndex:0,lastSuccessfulUsername:n,currentUsername:n===e.currentUsername?null:e.currentUsername});case u.d:var h=t.payload,v=h.suggestionID,g=h.suggestionIndex;return o({},e,{activeSuggestionID:v,activeSuggestionIndex:g});default:return e}},instances:function(e,t){var n,r;switch(void 0===e&&(e=d),t.type){case a.a:return h(e,t),c({},e,((n={})[t.payload.editorID]=f,n));case a.b:h(e,t);var u=t.payload,s=u.selection,o=u.editorID,i=e[o],l=i.lastGoodSelection;return c({},e,((r={})[o]=c({},i,{currentSelection:s,lastGoodSelection:null!==s?s:l}),r));default:return e}}}),m=n(1),p=function(e,t,n,r){return new(n||(n=Promise))(function(u,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function i(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?u(e.value):new n(function(t){t(e.value)}).then(o,i)}a((r=r.apply(e,t||[])).next())})},b=function(e,t){var n,r,u,s,o={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(u=2&s[0]?r.return:s[0]?r.throw||((u=r.return)&&u.call(r),0):r.next)&&!(u=u.call(r,s[1])).done)return u;switch(r=0,u&&(s=[2&s[0],u.value]),s[0]){case 0:case 1:u=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(u=(u=o.trys).length>0&&u[u.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!u||s[1]>u[0]&&s[1]<u[3])){o.label=s[1];break}if(6===s[0]&&o.label<u[1]){o.label=u[1],u=s;break}if(u&&o.label<u[2]){o.label=u[2],o.ops.push(s);break}u[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=u=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}};
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */Object(m.l)(function(){Object(r.b)("editor",g),function(){p(this,void 0,void 0,function(){var e,t;return b(this,function(r){switch(r.label){case 0:return(e=document.querySelectorAll(".richEditor")).length>0?[4,Promise.all([n.e(0),n.e(7)]).then(n.bind(null,404))]:[3,2];case 1:t=r.sent(),e.forEach(t.default),r.label=2;case 2:return[2]}})})}(),function(){p(this,void 0,void 0,function(){var e=this;return b(this,function(t){return document.addEventListener("X-EditCommentFormLoaded",function(t){return p(e,void 0,void 0,function(){var e,r;return b(this,function(u){switch(u.label){case 0:return(e=t.target)instanceof Element?(r=e.querySelector(".richEditor"))?[4,Promise.all([n.e(0),n.e(7)]).then(n.bind(null,404))]:[3,2]:[2];case 1:u.sent().default(r),u.label=2;case 2:return[2]}})})}),[2]})})}()})},24:function(e,t,n){"use strict";n.r(t);var r=n(1);
/**
 * Set wepback's public path.
 * Otherwise the lookups of dynamically imported webpack files can fail on sites that have a different webroot
 * Eg. installed in a subfolder / using Reverse Proxy.
 *
 * @author Adam Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license http://www.opensource.org/licenses/gpl-2.0.php GNU GPL v2
 */n.p=Object(r.e)("/")},32:function(e,t,n){"use strict";n.d(t,"d",function(){return s}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"e",function(){return l}),n.d(t,"f",function(){return d});var r=n(11),u=n(8),s="[mentions] set active suggestion",o="[mentions] load users request",i="[mentions] load users failure",a="[mentions] load users success",c=50;var l={loadUsersRequest:function(e){return Object(r.b)(o,{username:e})},loadUsersFailure:function(e,t){return Object(r.b)(i,{username:e,error:t})},loadUsersSuccess:function(e,t){return Object(r.b)(a,{username:e,users:t})},setActiveSuggestion:function(e,t){return Object(r.b)(s,{suggestionID:e,suggestionIndex:t})}},d={loadUsers:function(e){return function(t,n){var r=n().editor.mentions.usersTrie,s=r.getValue(e);if(null!=s)switch(s.status){case"SUCCESSFUL":return t(l.loadUsersSuccess(e,s.users));case"PENDING":return;case"FAILED":return t(l.loadUsersFailure(e,s.error))}var o=r.getValueFromPartialsOfWord(e);if(null!=o)switch(o.status){case"SUCCESSFUL":if(o.users.length<c)return t(l.loadUsersSuccess(e,function(e,t){var n=Intl.Collator("en",{usage:"search",sensitivity:"base",ignorePunctuation:!0,numeric:!0});return e.filter(function(e){if(e.name.length<t.length)return!1;var r=e.name.substring(0,t.length);return 0===n.compare(r,t)})}(o.users,e)))}t(l.loadUsersRequest(e));var i={name:e+"*",order:"mention",limit:c};return u.a.get("/users/by-names/",{params:i}).then(function(n){if(n.status>=500)throw new Error(n.data);var r=n.data.map(function(e){return e.domID="mentionSuggestion"+e.userID,e});t(l.loadUsersSuccess(e,r))}).catch(function(n){return t(l.loadUsersFailure(e,n))})}}}},33:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return o});var r=n(11),u="[instance] create",s="[instance] set selection",o={createInstance:function(e){return Object(r.b)(u,{editorID:e})},setSelection:function(e,t){return Object(r.b)(s,{editorID:e,selection:t})}};
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */}},[[133,2,0,1]]]);
//# sourceMappingURL=forum.min.js.map